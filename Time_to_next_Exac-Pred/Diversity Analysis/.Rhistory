library("vegan")
library(splitstackshape)
library(ggplot2)
i="BSL"
bac<-read.csv(paste0("./../Pre-processing/Pre-processed/bac_",i,".csv"),row.names = 1)
fun<-read.csv(paste0("./../Pre-processing/Pre-processed/fungi_",i,".csv"),row.names = 1)
vir<-read.csv(paste0("./../Pre-processing/Pre-processed/vir_",i,".csv"),row.names=1)
lab<-bac$Time.to.next.exacerbation
bac$Time.to.next.exacerbation<-NULL
fun$Time.to.next.exacerbation<-NULL
vir$Time.to.next.exacerbation<-NULL
bac<-(bac/rowSums(bac))*100
fun<-(fun/rowSums(fun))*100
vir<-(vir/rowSums(vir))*100; vir[is.na(vir)]<-0
vir$Time.to.next.exacerbation<-lab
#Merged data
tmp_data<-merge(bac,fun,by="row.names",all=TRUE)
row.names(tmp_data)<-tmp_data$Row.names;tmp_data$Row.names<-NULL
data<-merge(tmp_data,vir,by="row.names",all=TRUE)
row.names(data)<-data$Row.names;data$Row.names<-NULL
X<-data;X$Time.to.next.exacerbation<-NULL
X<-(X/rowSums(X))*100
H<-diversity(X,"shannon") #Shannon
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2<12*7,"1","2")
plt_data$V2=as.factor(plt_data$V2)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation")+
ylab("Shanno Diversity index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
plt_data$V2<-ifelse(plt_data$V2<12*7,"<12","12>")
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2<12*7,"<12","12>")
plt_data$V2=as.factor(plt_data$V2)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2>12*7,">12","<12")
plt_data$V2=as.factor(plt_data$V2)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
print(i)
print(wilcox.test(H~V2,plt_data))
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"))
print(p)
dev.off()
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank())
print(p)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.key = element_blank())
print(p)
?theme
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend. position = "none)
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#619CFF", "#F8766D"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
dev.off()
source('~/OneDrive/3.SNF/Nature_Med-resubmission/Time_to_next_Exac-Pred/Diversity Analysis/diversity_categorical.R', echo=TRUE)
library("vegan")
library(splitstackshape)
library(ggplot2)
library("vegan")
library(splitstackshape)
library(ggplot2)
for (i in c("BSL","EX1","P1")){
bac<-read.csv(paste0("./../Pre-processing/Pre-processed/bac_",i,".csv"),row.names = 1)
fun<-read.csv(paste0("./../Pre-processing/Pre-processed/fungi_",i,".csv"),row.names = 1)
vir<-read.csv(paste0("./../Pre-processing/Pre-processed/vir_",i,".csv"),row.names=1)
lab<-bac$Time.to.next.exacerbation
bac$Time.to.next.exacerbation<-NULL
fun$Time.to.next.exacerbation<-NULL
vir$Time.to.next.exacerbation<-NULL
bac<-(bac/rowSums(bac))*100
fun<-(fun/rowSums(fun))*100
vir<-(vir/rowSums(vir))*100; vir[is.na(vir)]<-0
vir$Time.to.next.exacerbation<-lab
#Merged data
tmp_data<-merge(bac,fun,by="row.names",all=TRUE)
row.names(tmp_data)<-tmp_data$Row.names;tmp_data$Row.names<-NULL
data<-merge(tmp_data,vir,by="row.names",all=TRUE)
row.names(data)<-data$Row.names;data$Row.names<-NULL
X<-data;X$Time.to.next.exacerbation<-NULL
X<-(X/rowSums(X))*100
H<-diversity(X,"shannon") #Shannon
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2>12*7,">12","<12")
plt_data$V2=as.factor(plt_data$V2)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#F8766D","#619CFF"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
dev.off()
print(i)
print(wilcox.test(H~V2,plt_data))
}
library(diverse)
?diverse
library("vegan")
library(splitstackshape)
library(ggplot2)
for (i in c("BSL","EX1","P1")){
bac<-read.csv(paste0("./../Pre-processing/Pre-processed/bac_",i,".csv"),row.names = 1)
fun<-read.csv(paste0("./../Pre-processing/Pre-processed/fungi_",i,".csv"),row.names = 1)
vir<-read.csv(paste0("./../Pre-processing/Pre-processed/vir_",i,".csv"),row.names=1)
lab<-bac$Time.to.next.exacerbation
bac$Time.to.next.exacerbation<-NULL
fun$Time.to.next.exacerbation<-NULL
vir$Time.to.next.exacerbation<-NULL
bac<-(bac/rowSums(bac))*100
fun<-(fun/rowSums(fun))*100
vir<-(vir/rowSums(vir))*100; vir[is.na(vir)]<-0
vir$Time.to.next.exacerbation<-lab
#Merged data
tmp_data<-merge(bac,fun,by="row.names",all=TRUE)
row.names(tmp_data)<-tmp_data$Row.names;tmp_data$Row.names<-NULL
data<-merge(tmp_data,vir,by="row.names",all=TRUE)
row.names(data)<-data$Row.names;data$Row.names<-NULL
X<-data;X$Time.to.next.exacerbation<-NULL
X<-(X/rowSums(X))*100
H<-diversity(X,"berger-parker") #Shannon
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2>12*7,">12","<12")
plt_data$V2=as.factor(plt_data$V2)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#F8766D","#619CFF"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
dev.off()
print(i)
print(wilcox.test(H~V2,plt_data))
}
H
X
t(X)
t(X)X
X
diversity(t(X),"berger-parker")
library("vegan")
library(splitstackshape)
library(ggplot2)
for (i in c("BSL","EX1","P1")){
bac<-read.csv(paste0("./../Pre-processing/Pre-processed/bac_",i,".csv"),row.names = 1)
fun<-read.csv(paste0("./../Pre-processing/Pre-processed/fungi_",i,".csv"),row.names = 1)
vir<-read.csv(paste0("./../Pre-processing/Pre-processed/vir_",i,".csv"),row.names=1)
lab<-bac$Time.to.next.exacerbation
bac$Time.to.next.exacerbation<-NULL
fun$Time.to.next.exacerbation<-NULL
vir$Time.to.next.exacerbation<-NULL
bac<-(bac/rowSums(bac))*100
fun<-(fun/rowSums(fun))*100
vir<-(vir/rowSums(vir))*100; vir[is.na(vir)]<-0
vir$Time.to.next.exacerbation<-lab
#Merged data
tmp_data<-merge(bac,fun,by="row.names",all=TRUE)
row.names(tmp_data)<-tmp_data$Row.names;tmp_data$Row.names<-NULL
data<-merge(tmp_data,vir,by="row.names",all=TRUE)
row.names(data)<-data$Row.names;data$Row.names<-NULL
X<-data;X$Time.to.next.exacerbation<-NULL
X<-(X/rowSums(X))*100
#H<-diversity(X,"shannon") #Shannon
H<-diversity(as.matrix(X),"berger-parker",method = "bray-curtis")$berger.parker.D
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2>12*7,">12","<12")
plt_data$V2=as.factor(plt_data$V2)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#F8766D","#619CFF"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Shannon Diversity Index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
dev.off()
print(i)
print(wilcox.test(H~V2,plt_data))
}
plt_data
library("vegan")
library(splitstackshape)
library(ggplot2)
for (i in c("BSL","EX1","P1")){
bac<-read.csv(paste0("./../Pre-processing/Pre-processed/bac_",i,".csv"),row.names = 1)
fun<-read.csv(paste0("./../Pre-processing/Pre-processed/fungi_",i,".csv"),row.names = 1)
vir<-read.csv(paste0("./../Pre-processing/Pre-processed/vir_",i,".csv"),row.names=1)
lab<-bac$Time.to.next.exacerbation
bac$Time.to.next.exacerbation<-NULL
fun$Time.to.next.exacerbation<-NULL
vir$Time.to.next.exacerbation<-NULL
bac<-(bac/rowSums(bac))*100
fun<-(fun/rowSums(fun))*100
vir<-(vir/rowSums(vir))*100; vir[is.na(vir)]<-0
vir$Time.to.next.exacerbation<-lab
#Merged data
tmp_data<-merge(bac,fun,by="row.names",all=TRUE)
row.names(tmp_data)<-tmp_data$Row.names;tmp_data$Row.names<-NULL
data<-merge(tmp_data,vir,by="row.names",all=TRUE)
row.names(data)<-data$Row.names;data$Row.names<-NULL
X<-data;X$Time.to.next.exacerbation<-NULL
X<-(X/rowSums(X))*100
#H<-diversity(X,"shannon") #Shannon
H<-diversity(as.matrix(X),"berger-parker",method = "bray-curtis")$berger.parker.D
plt_data=as.data.frame(cbind(H,data$Time.to.next.exacerbation))
plt_data$V2<-ifelse(plt_data$V2>12*7,">12","<12")
plt_data$V2=as.factor(plt_data$V2)
png(paste0(i,".png"),height =3.5 ,width = 3,units = "in",res = 300)
p <- ggplot(plt_data,aes(x=V2, y=H,fill=V2)) +
scale_fill_manual(values=c("#F8766D","#619CFF"))+
geom_boxplot() +geom_jitter(width = 0.03, height = 0)+
xlab("Time to next exacerbation (weeks)")+
ylab("Bergerâ€“Parker index")+ggtitle(i)+
theme(panel.background = element_blank(),
axis.line = element_line(colour = "black"),legend.title = element_blank(),legend.position = "none")
print(p)
dev.off()
print(i)
print(wilcox.test(H~V2,plt_data))
}
